/* --------------------------------------------------------------------------------
  This file was automatically generated by the Athlos Project Editor.
  Athlos Project Editor, v1.0 BETA
-------------------------------------------------------------------------------- */

package com.example.marspioneer.client.websocket;

import com.example.marspioneer.client.MPClient;
import com.example.marspioneer.client.simulation.Bot;
import com.example.marspioneer.proto.BuildResponse;
import com.google.protobuf.InvalidProtocolBufferException;
import com.neovisionaries.ws.client.WebSocketException;
import com.raylabz.mocha.binary.client.BinaryWebSocketClient;

import java.io.IOException;

public class BotBuildHubStub extends BinaryWebSocketClient {

    private Bot bot;

    public BotBuildHubStub(Bot bot) throws IOException, WebSocketException {
        super("ws://mars-pioneer-322210.oa.r.appspot.com/api/action/buildHub");
        this.bot = bot;
    }

    @Override
    public void onReceive(byte[] bytes) {
        try {
            BuildResponse response = BuildResponse.parseFrom(bytes);
            handleResponse(response);
        } catch (InvalidProtocolBufferException e) {
            e.printStackTrace();
//            bot.getCanvas().showMessage(e.getMessage());
        }
    }
    
    public void handleResponse(BuildResponse response) {
        if (response.getStatus() == BuildResponse.Status.OK) {
//            System.out.println("Hub built by " + bot.getWorldSession().getId());
        } else {
//            bot.getCanvas().showMessage(response.getMessage());
//            System.err.println(response.getMessage());
        }
    }

}

